<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>关于性能优化 | 文废画渣の博客</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="文废画渣の博客">
    <link rel="preload" href="/assets/css/0.styles.ccac5a78.css" as="style"><link rel="preload" href="/assets/js/app.8ff14af3.js" as="script"><link rel="preload" href="/assets/js/2.e471cf53.js" as="script"><link rel="preload" href="/assets/js/15.fa69ced8.js" as="script"><link rel="prefetch" href="/assets/js/10.261832bc.js"><link rel="prefetch" href="/assets/js/11.5bb93859.js"><link rel="prefetch" href="/assets/js/12.ae4c9db8.js"><link rel="prefetch" href="/assets/js/13.c0a28506.js"><link rel="prefetch" href="/assets/js/14.c0c6f134.js"><link rel="prefetch" href="/assets/js/16.7b1b0b87.js"><link rel="prefetch" href="/assets/js/17.917155ae.js"><link rel="prefetch" href="/assets/js/18.a4dd5d85.js"><link rel="prefetch" href="/assets/js/19.2eff09a1.js"><link rel="prefetch" href="/assets/js/20.f75604aa.js"><link rel="prefetch" href="/assets/js/21.4492ad78.js"><link rel="prefetch" href="/assets/js/3.c1ff3a62.js"><link rel="prefetch" href="/assets/js/4.5cd8315e.js"><link rel="prefetch" href="/assets/js/5.3e9016c8.js"><link rel="prefetch" href="/assets/js/6.8acc38a1.js"><link rel="prefetch" href="/assets/js/7.aa57eebb.js"><link rel="prefetch" href="/assets/js/8.f11d3f93.js"><link rel="prefetch" href="/assets/js/9.cf9cfaf9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccac5a78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文废画渣の博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wenfeihuazha" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wenfeihuazha" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub地址
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>关于性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/JavaScript/Performance.html#介绍" class="sidebar-link">介绍</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/JavaScript/Performance.html#javascript语言优化" class="sidebar-link">JavaScript语言优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/Performance.html#内存管理" class="sidebar-link">内存管理</a></li><li class="sidebar-sub-header"><a href="/JavaScript/Performance.html#垃圾回收与常见gc算法" class="sidebar-link">垃圾回收与常见GC算法</a></li><li class="sidebar-sub-header"><a href="/JavaScript/Performance.html#v8-引擎的垃圾回收" class="sidebar-link">V8 引擎的垃圾回收</a></li><li class="sidebar-sub-header"><a href="/JavaScript/Performance.html#performance-工具" class="sidebar-link">Performance 工具</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="关于性能优化"><a href="#关于性能优化" class="header-anchor">#</a> 关于性能优化</h1> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <ul><li>性能优化是不可避免的</li> <li>哪些内容可以看做是性能优化</li> <li>无处不在的前端性能优化</li></ul> <h2 id="javascript语言优化"><a href="#javascript语言优化" class="header-anchor">#</a> JavaScript语言优化</h2> <h3 id="内存管理"><a href="#内存管理" class="header-anchor">#</a> 内存管理</h3> <h4 id="介绍-2"><a href="#介绍-2" class="header-anchor">#</a> 介绍</h4> <ul><li>内存:由可读写单元组成,便是一片可操作性空间</li> <li>管理:人为的去操作一片空间的申请,使用和释放</li> <li>内存管理: 开发者主动申请空间,使用空间,释放空间</li> <li>管理流程:申请 -- 使用 -- 释放</li></ul> <h4 id="javascript中的内存管理"><a href="#javascript中的内存管理" class="header-anchor">#</a> JavaScript中的内存管理</h4> <ul><li>申请内存空间</li> <li>使用内存空间</li> <li>释放内存空间</li></ul> <h3 id="垃圾回收与常见gc算法"><a href="#垃圾回收与常见gc算法" class="header-anchor">#</a> 垃圾回收与常见GC算法</h3> <h4 id="javascript中的垃圾"><a href="#javascript中的垃圾" class="header-anchor">#</a> JavaScript中的垃圾</h4> <ul><li>JavaScript 中内存管理是自动的</li> <li>对象不再被引用时是垃圾</li> <li>对象不能从根上访问到时是垃圾</li></ul> <h4 id="javascript中的可达对象"><a href="#javascript中的可达对象" class="header-anchor">#</a> JavaScript中的可达对象</h4> <ul><li>可以访问到的对象就是可达对象(引用,作用域链)</li> <li>可达的标准就是从根出发是否能够被找到</li> <li>JavaScript中的根就可以理解为是全局变量对象</li></ul> <h5 id="介绍-3"><a href="#介绍-3" class="header-anchor">#</a> 介绍</h5> <ul><li>GC 就是垃圾回收机制的简写</li> <li>GC 可以找到内存中的垃圾,并释放和回收空间</li> <li>算法就是工作时查找和回收所遵循的规则</li></ul> <h5 id="常见-gc-算法"><a href="#常见-gc-算法" class="header-anchor">#</a> 常见 GC 算法</h5> <h6 id="引用计数"><a href="#引用计数" class="header-anchor">#</a> 引用计数</h6> <ul><li>核心思想: 设置引用数,判断当前引用数是否为0</li> <li>引用计数器</li> <li>当引用关系改变时修改引用数字</li> <li>引用数字为0时立即回收</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> user1 <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> user2 <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> user3 <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> nameList <span class="token operator">=</span> <span class="token punctuation">[</span>user1<span class="token punctuation">.</span>age<span class="token punctuation">,</span>user2<span class="token punctuation">.</span>age<span class="token punctuation">,</span>user3<span class="token punctuation">.</span>age<span class="token punctuation">]</span>
<span class="token comment">// user1 user2 user3 仍然被引用 所以不会被回收</span>


<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> num1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> num2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//在执行后 内部num1 num2 就会被回收</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>优点:</li></ul> <blockquote><ol><li>发现垃圾时立即回收</li> <li>最大限度减少程序暂停</li></ol></blockquote> <ul><li>缺点:</li></ul> <blockquote><ol><li>无法回收循环引用的对象</li> <li>时间开销大</li></ol></blockquote> <h6 id="标记清除"><a href="#标记清除" class="header-anchor">#</a> 标记清除</h6> <ul><li>原理</li></ul> <blockquote><ol><li>核心思想 : 分标记和清楚二个阶段完成</li> <li>遍历所有对象找标记活动对象</li> <li>遍历所有对象清楚没有标记的对象</li> <li>回收相应的空间</li></ol></blockquote> <ul><li>优点</li></ul> <blockquote><ol><li>解决循环引用对象的问题</li></ol></blockquote> <ul><li>缺点</li></ul> <blockquote><ol><li>释放后地址不连续(空间碎片化)</li> <li>不能立即回收垃圾对象</li></ol></blockquote> <h6 id="标记整理"><a href="#标记整理" class="header-anchor">#</a> 标记整理</h6> <ul><li>原理</li></ul> <blockquote><ol><li>标记整理可以看做是标记清除的增强</li> <li>标记阶段的操作和标记清除一致</li> <li>清除阶段会先执行整理,移动对象位置</li></ol></blockquote> <ul><li>优点:</li></ul> <blockquote><ol><li>减少碎片化空间</li></ol></blockquote> <ul><li>缺点</li></ul> <blockquote><ol><li>不能立即回收垃圾对象</li></ol></blockquote> <h3 id="v8-引擎的垃圾回收"><a href="#v8-引擎的垃圾回收" class="header-anchor">#</a> V8 引擎的垃圾回收</h3> <ul><li>认识V8</li></ul> <blockquote><ol><li>V8 是一款主流的JavaScript执行引擎</li> <li>V8 采用即时编译</li> <li>V8 内存设限</li></ol></blockquote> <ul><li>V8 垃圾回收策略</li></ul> <blockquote><ol><li>采用分代回收的思想</li> <li>内存分为新生代,老生代</li> <li>针对不同对象采用不同算法</li></ol></blockquote> <ul><li>V8 中常用的 GC 算法</li></ul> <blockquote><ol><li>分代回收</li> <li>空间赋值</li> <li>标记清除</li> <li>标记整理</li> <li>标记增量</li></ol></blockquote> <ul><li>V8 新生代对象</li></ul> <blockquote><ol><li>V8 内存空间一分为二</li> <li>小空间用于存储新生代对象(32M|16M)</li> <li>新生代指的是存活时间较短的对象(如局部变量)</li></ol></blockquote> <ul><li>V8 如何回收新生代对象</li></ul> <blockquote><ol><li>回收过程采用复制算法 + 标记整理</li> <li>新生代内存区分为二个等大小空间 (From | to)</li> <li>使用空间为 From , 空闲空间为 To</li> <li>活动对象存储于 From 空间</li> <li>标记整理后将活动对象拷贝值 To</li> <li>From 与 To 交换空间完成释放</li></ol></blockquote> <ul><li>V8 如何回收新生代对象细节说明</li></ul> <blockquote><ol><li>拷贝过程中可能出现晋升</li> <li>晋升就是将新生代对象移动至老生代</li> <li>一轮GC还存活的新生代需要晋升</li> <li>To 空间的使用率超过25%</li></ol></blockquote> <ul><li>V8 老年代对象</li></ul> <blockquote><ol><li>老年代对象存放在右侧老生代区域</li> <li>64位操作系统 1.4G,32G操作系统700M</li> <li>老年代对象就是指存活时间较长的对象</li></ol></blockquote> <ul><li>V8 老年代对象回收实现</li></ul> <blockquote><ol><li>主要采用标记清除,标记整理,增量标记算法</li> <li>首先使用标记清除完成垃圾空间的回收</li> <li>采用标记整理进行空间优化</li> <li>采用增量标记进行效率优化</li></ol></blockquote> <ul><li>新生代区域和老年代区域细节对比</li></ul> <blockquote><ol><li>新生代区域垃圾回收使用空间换时间</li> <li>老生代区域垃圾回收不适合复制算法</li></ol></blockquote> <ul><li>总结</li></ul> <blockquote><ol><li>V8 是一款主流的JavaScript执行引擎</li> <li>V8 内存设置上限</li> <li>V8 采用基于分代回收思想实现垃圾回收</li> <li>V8 内存分为新生代和老生代</li> <li>V8 垃圾回收常见 GC 算法</li></ol></blockquote> <h3 id="performance-工具"><a href="#performance-工具" class="header-anchor">#</a> Performance 工具</h3> <ul><li>为什么使用 Performance</li></ul> <blockquote><ol><li>GC 的目的是为了实现内存空间的良性循环</li> <li>良性循环的基石是合理使用</li> <li>时刻关注才能确定是否合理</li> <li>Performance 提供多种监控方法</li></ol></blockquote> <p>总结: <strong>通过Performance时刻监控内存</strong></p> <ul><li>使用步骤</li></ul> <blockquote><ol><li>打开浏览器输入目标网站</li> <li>进入开发人员工具面板,选择性能</li> <li>开启录制功能,访问具体界面</li> <li>执行用户行为,一段时间后停止录制</li> <li>分析界面中记录的内存信息</li></ol></blockquote> <ul><li>出现问题的体现</li></ul> <blockquote><ol><li>页面出现延迟加载或经常性暂停</li> <li>页面持续性出现糟糕的性能</li> <li>页面的性能随时间延长越来越差</li></ol></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/8/2020, 9:16:38 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8ff14af3.js" defer></script><script src="/assets/js/2.e471cf53.js" defer></script><script src="/assets/js/15.fa69ced8.js" defer></script>
  </body>
</html>
