---
title: 'å…³äº this'
date: 2020-10-13
# æ°¸ä¹…é“¾æ¥
# permalink: '/hello-world'
# æ–‡ç« è®¿é—®å¯†ç 
# keys: '123'
# æ˜¯å¦å‘å¸ƒæ–‡ç« 
# publish: true
# ç½®é¡¶: é™åºï¼Œå¯ä»¥æŒ‰ç…§ 1, 2, 3, ... æ¥é™ä½ç½®é¡¶æ–‡ç« çš„æ’åˆ—ä¼˜å…ˆçº§
# sticky: 1
# sidebar: false
# sidebarDepth: 2
# isTimeLine: false
# isShowComment: true
tags:
- 'JavaScriptåŸºç¡€'
- 'åšæ–‡'
categories:
- 'JavaScriptåŸºç¡€'
---

å¯¹äº JavaScript ä¸­çš„ this,ä½ æ˜¯å¦è¿˜æœ‰å›°æƒ‘å‘¢?

<!-- more -->

å·¥ä½œç»éªŒæ¯”è¾ƒä¹…çš„å‰ç«¯,åº”è¯¥éƒ½è®°å¾—å½“åˆè¢« jQuery æ”¯é…çš„ææ€–.ç»å¸¸éœ€è¦åœ¨å‡½æ•°å¼€å¤´å®šä¹‰ä¸€ä¸ª that/vm/self æ¥ä»£æŒ‡ this.

æ‰€ä»¥è¡ç”Ÿå‡ºå¾ˆå¤šæƒ…å†µä¸‹ this çš„æŒ‡å‘è‡ªå·±éƒ½çœ‹ä¸æ‡‚çš„æƒ…å†µ.é’ˆå¯¹äºæ­¤,æƒ³ç€æœ‰æ—¶é—´åšä»½æ•´ç†.å¥½å¥½ç ”ç©¶ä¸€ä¸‹ this æŒ‡å‘.

## å‰æ

åœ¨ **ä¸¥æ ¼æ¨¡å¼** ä¸‹, this çš„æŒ‡å‘æ°¸è¿œéƒ½æ˜¯ undefined.

## æ™®é€šå‡½æ•°ä¸­çš„ this

æˆ‘ä»¬å†™å‡ ä¸ªä¾‹å­æ¥åˆ†æ

```js
function test(name) {
    console.log(name)
    console.log(this)
}
test('Tom')  //this æŒ‡å‘ window

let obj = {
  a:1,
  func:function(name){
    console.log(name)
    console.log(this) // this æŒ‡å‘ obj
  }
}
obj.func('Jerry')
```

å’¦?å†™å®Œä¸Šè¿°ä¾‹å­æˆ‘å‘ç°è™½ç„¶æ˜¯ä¸€æ ·çš„å‡½æ•°å†™æ³•,ä½†æ˜¯ä»–ä»¬çš„ this æŒ‡å‘æ˜¯ä¸åŒçš„.é‚£æˆ‘ä»¬å†æ¥è¯•è¯•å¦ä¸€ç§æ–¹å¼

```js
let obj = {
  a:1,
  func:function(){
    console.log(this) 
  }
}
var func2 = obj.func;
func2(); // this æŒ‡å‘ Window

function func3 (){
  console.log(this)
};

let obj2 = {
  a:2,
  func3:func3,
}

obj2.func3(); // this æŒ‡å‘ obj2

```

è¿™ä¸ªæ—¶å€™æˆ‘å¿ƒä¸­æœ‰ä¸€ä¸ªçŒœæµ‹~

**thisçš„æŒ‡å‘ä¸è°å»è°ƒç”¨å®ƒæœ‰å…³,æŒ‡å‘è°ƒç”¨çš„çˆ¶çº§**

æˆ‘çš„æ¨æµ‹åŸå› å¦‚ä¸‹:

- ç›´æ¥å£°æ˜å‡½æ•°æ—¶ func() => window.func() æ‰€ä»¥æŒ‡å‘ window

- å£°æ˜åœ¨å¯¹è±¡ä¸­æ—¶ obj.func() æŒ‡å‘ obj å¯¹è±¡

æŠ±ç€è¿™ä¸ªç»“è®º,æˆ‘ä»¬å†æ¥çœ‹ä¸‹åœ¨ setTimeout/setInterval ä¸­çš„ this

## setTimeout/setInterval ä¸­çš„ this

ä¸¾ä¸ªæ —å­

```js
let obj1 = {
  a:'xiaoming',//è¿™ä¸ªå˜é‡æ˜¯ä¸ºäº†åœ¨è¾“å‡ºobj1çš„æ—¶å€™ä¸è¦åªæœ‰ä¸€ä¸ªfunc,è™½ç„¶ä¹Ÿå¯,ä½†æ˜¯ä¿ºä»¬è§‰å¾—æ²¡å•¥è¾¨è¯†åº¦
  func:function(){
    setTimeout(function(){
      console.log(this)
    },0)
  }
}
obj1.func(); // this æŒ‡å‘ window
```

å’¦?è¿™ä¸ªç»“è®ºæ˜¯ä¸æ˜¯å’Œä¸Šè¿°æˆ‘è¯´çš„æ€»ç»“ä¸å¤ªä¸€æ ·å‘¢?

å…¶å®**ä¸æ˜¯çš„**,å› ä¸º setTimeout å‡½æ•°æ˜¯ window è‡ªå¸¦çš„å‡½æ•°ä¹‹ä¸€,æ‰€ä»¥å½“æˆ‘ä»¬å†™ setTimeout å…¶å®ç­‰ä»·äº window.setTimeout,æ‰€ä»¥æŒ‡å‘window,è¿™ä¸€ç‚¹æ¯›ç—…ä¹Ÿæ²¡æœ‰ ğŸ¶

æ‰€ä»¥,æˆ‘è§‰å¾— æˆ‘æ€»ç»“çš„ æ²¡æ¯›ç—…ğŸ¶(ç‹—å¤´ä¿å‘½)

**å…¶å®è¿˜æœ‰å…¶ä»–çš„æ–¹æ³•å¯ä»¥æ›´æ”¹thisæŒ‡å‘,å¦‚call,bind,applyç­‰**

>ç­‰æœ‰ç©ºäº†,æˆ‘å†å†™ä¸Šè¿°ç›¸å…³çš„æ–‡ç« 

>> ä½ é—®æˆ‘å•¥æ—¶å€™æœ‰ç©º?æ©...è°çŸ¥é“å‘¢ğŸ¶
## ç®­å¤´å‡½æ•°ä¸­çš„ this

åœ¨ ES6 çš„å¤§ç‰ˆæœ¬æ›´æ–°ä¸­,å®˜æ–¹ç»ˆäºè§£å†³äº† this è°ƒç”¨çš„é—®é¢˜,é€€å‡ºäº†ä¸€ç§æ–°çš„å‡½æ•°å†™æ³•. **ç®­å¤´å‡½æ•°**
åœ¨ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰**this**çš„ç»‘å®š. å¯ä»¥çœ‹ä¸€ä¸ª MDN ä¸Šçš„ç¤ºä¾‹

``` js
'use strict';
var obj = {
  a: 10
};

Object.defineProperty(obj, "b", {
  get: () => {
    console.log(this.a, typeof this.a, this);
    return this.a+10; 
   // ä»£è¡¨å…¨å±€å¯¹è±¡ 'Window', å› æ­¤ 'this.a' è¿”å› 'undefined'
  }
});

obj.b; // undefined   "undefined"   Window {postMessage: Æ’, blur: Æ’, focus: Æ’, close: Æ’, frames: Window, â€¦}

```

æ‰€ä»¥å…³äºç®­å¤´å‡½æ•°,æˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¥å¹¿å‘Šè¯­æ¥å½¢å®¹.

**æˆ‘ä»¬ä¸ç”Ÿäº§ this ,æˆ‘ä»¬åªæ˜¯ this çš„æ¬è¿å·¥**

å¥½äº†,æœ¬ç¯‡æ–‡ç« åˆ°æ­¤ç»“æŸ.å¦‚æœæœ‰é”™è¯¯,å¯ä»¥åœ¨è¯„è®ºä¸­æŒ‡å‡º.

å°èœé¸¡ä¸€æš,å¦‚æœ‰é”™è¯¯å¤šå¤šè§è°…